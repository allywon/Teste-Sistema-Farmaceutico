unit DM_MySQL;

interface

uses
  System.SysUtils, System.Classes, FireDAC.Stan.Intf, FireDAC.Stan.Option,
  FireDAC.Stan.Error, FireDAC.UI.Intf, FireDAC.Phys.Intf, FireDAC.Stan.Def,
  FireDAC.Stan.Pool, FireDAC.Stan.Async, FireDAC.Phys, FireDAC.Phys.MySQL,
  FireDAC.Phys.MySQLDef, FireDAC.VCLUI.Wait, FireDAC.Stan.Param, FireDAC.DatS,
  FireDAC.DApt.Intf, FireDAC.DApt, Data.DB, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client;

type
  TDM_MySQL = class(TDataModule)
    FDConnection: TFDConnection;
    FDPhysMySQLDriverLink: TFDPhysMySQLDriverLink;
    qryClientes: TFDQuery;
    qryClientesid: TFDAutoIncField;
    qryClientesnome: TStringField;
    qryClientesemail: TStringField;
    qryClientestelefone: TStringField;
    dsClientes: TDataSource;
    procedure DataModuleCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    function ConectarBanco: Boolean;
    procedure DesconectarBanco;
  end;

var
  DM_MySQL: TDM_MySQL;

implementation

{%CLASSGROUP 'Vcl.Controls.TControl'}

{$R *.dfm}

procedure TDM_MySQL.DataModuleCreate(Sender: TObject);
begin
  FDConnection.Connected := False;
  FDPhysMySQLDriverLink.VendorLib := ExtractFilePath(ParamStr(0)) + 'libmysql.dll';
end;

function TDM_MySQL.ConectarBanco: Boolean;
begin
  Result := False;
  try
    FDConnection.Params.Clear;
    FDConnection.Params.Add('DriverID=MySQL');
    FDConnection.Params.Add('Server=localhost');
    FDConnection.Params.Add('Port=3306');
    FDConnection.Params.Add('Database=meubancodados');
    FDConnection.Params.Add('User_Name=root');
    FDConnection.Params.Add('Password=senha');
    FDConnection.Params.Add('CharacterSet=utf8');
    FDConnection.Connected := True;
    Result := True;
  except
    on E: Exception do
    begin
      Result := False;
    end;
  end;
end;

procedure TDM_MySQL.DesconectarBanco;
begin
  FDConnection.Connected := False;
end;

end.
